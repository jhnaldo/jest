[33mPerformPromiseThen[0m
[33m- Inst: 46 / 47 (97.87%)[0m
[33m- Cond: 7944 / 14 (56742.86%)[0m
[32m+ 25300 [-]   : { ... }[0m
[32m+ 25301 [-]   : app __x0__ = (IsPromise promise)[0m
[32m+ 25302 [-]   : assert (= __x0__ true)[0m
[32m+ 25303 [[32mT[0m/[32mT[0m[32m]: if (! (= resultCapability absent)) ... else ...[0m
[32m+ 25304 [-]   : {}[0m
[32m+ 25305 [-]   : resultCapability = undefined[0m
[32m+ 25306 [-]   : app __x1__ = (IsCallable onFulfilled)[0m
[32m+ 25307 [[32mT[0m/[32mT[0m[32m]: if (= __x1__ false) ... else ...[0m
[32m+ 25308 [-]   : onFulfilled = undefined[0m
[32m+ 25309 [-]   : {}[0m
[32m+ 25310 [-]   : app __x2__ = (IsCallable onRejected)[0m
[32m+ 25311 [[32mT[0m/[32mT[0m[32m]: if (= __x2__ false) ... else ...[0m
[32m+ 25312 [-]   : onRejected = undefined[0m
[32m+ 25313 [-]   : {}[0m
[32m+ 25314 [-]   : let fulfillReaction = (new PromiseReaction("Capability" -> resultCapability, "Type" -> CONST_Fulfill, "Handler" -> onFulfilled))[0m
[32m+ 25315 [-]   : let rejectReaction = (new PromiseReaction("Capability" -> resultCapability, "Type" -> CONST_Reject, "Handler" -> onRejected))[0m
[32m+ 25316 [[32mT[0m/[32mT[0m[32m]: if (= promise["PromiseState"] CONST_pending) ... else ...[0m
[32m+ 25317 [-]   : { ... }[0m
[32m+ 25318 [-]   : append fulfillReaction -> promise["PromiseFulfillReactions"][0m
[32m+ 25319 [-]   : append rejectReaction -> promise["PromiseRejectReactions"][0m
[32m+ 25320 [[32mT[0m/[32mT[0m[32m]: if (= promise["PromiseState"] CONST_fulfilled) ... else ...[0m
[32m+ 25321 [-]   : { ... }[0m
[32m+ 25322 [-]   : let value = promise["PromiseResult"][0m
[32m+ 25323 [-]   : app __x3__ = (NewPromiseReactionJob fulfillReaction value)[0m
[32m+ 25324 [-]   : let fulfillJob = __x3__[0m
[32m+ 25325 [-]   : app __x4__ = (HostEnqueuePromiseJob fulfillJob["Job"] fulfillJob["Realm"])[0m
[32m+ 25326 [-]   : __x4__[0m
[32m+ 25327 [-]   : { ... }[0m
[32m+ 25328 [-]   : assert (= promise["PromiseState"] CONST_rejected)[0m
[32m+ 25329 [-]   : let reason = promise["PromiseResult"][0m
[32m+ 25330 [[32mT[0m/[31mF[0m[32m]: if (= promise["PromiseIsHandled"] false) ... else ...[0m
[32m+ 25331 [-]   : { ... }[0m
[32m+ 25332 [-]   : app __x5__ = (HostPromiseRejectionTracker promise "handle")[0m
[32m+ 25333 [-]   : __x5__[0m
[31m- 25334 [-]   : {}[0m
[32m+ 25335 [-]   : app __x6__ = (NewPromiseReactionJob rejectReaction reason)[0m
[32m+ 25336 [-]   : let rejectJob = __x6__[0m
[32m+ 25337 [-]   : app __x7__ = (HostEnqueuePromiseJob rejectJob["Job"] rejectJob["Realm"])[0m
[32m+ 25338 [-]   : __x7__[0m
[32m+ 25339 [-]   : promise["PromiseIsHandled"] = true[0m
[32m+ 25340 [[32mT[0m/[32mT[0m[32m]: if (= resultCapability undefined) ... else ...[0m
[32m+ 25341 [-]   : { ... }[0m
[32m+ 25342 [-]   : app __x8__ = (WrapCompletion undefined)[0m
[32m+ 25343 [-]   : return __x8__[0m
[32m+ 25344 [-]   : { ... }[0m
[32m+ 25345 [-]   : app __x9__ = (WrapCompletion resultCapability["Promise"])[0m
[32m+ 25346 [-]   : return __x9__[0m
